# Bug Bounty Checklist for Web App - Web 应用程序的错误赏金清单

> This checklist may help you to have a good methodology for bug bounty hunting 
>这个清单可以帮助你有一个很好的方法来寻找漏洞赏金
> When you have done a action, don't forget to check ;) 
>当你做了一个动作时，不要忘记检查;)
> Happy hunting ! 
>狩猎快乐！

## 目录

* [Recon on wildcard domain - 泛域名侦查](#"Recon_on_wildcard_domain")
* [Single domain - 单个域名](#Single_domain)
* [Information Gathering - 信息收集](#Information)
* [Configuration Management - 配置管理](#Configuration)
* [Secure Transmission - 安全传输](#Transmission)
* [Authentication - 认证](#Authentication)
* [Session Management - 会话管理](#Session)
* [Authorization - 授权](#Authorization)
* [Data Validation - 数据验证](#Validation)
* [Denial of Service - 拒绝服务](#Denial)
* [Business Logic - 业务逻辑](#Business)
* [Cryptography - 密码学](#Cryptography)
* [File Uploads - 文件上传](#File)
* [Card Payment - 卡支付](#Card)
* [HTML 5](#HTML)


## <a name="Recon_on_wildcard_domain">Recon on wildcard domain - 泛域名侦查</a> 
此侦察过程来自 [0xpatrick 子域枚举工作流程](https://0xpatrik.com/subdomain-enumeration-2019/)

- [ ] 运行Amass
- [ ] 运行Subfinder
- [ ] 运行Rapid7 FDNS
- [ ] 使用commonspeak2 list
- [ ] 运行massdns
- [ ] 运行altdns
- [ ] 运行massdns


## <a name="Single_domain">Single Domain - 单个域名</a> 

### Scanning - 扫描 
- [ ] Arachni Scan 
- [ ] Owasp ZAp Scan 
- [ ] Burp Spider 
- [ ] Burp Scanning 
- [ ] Wayback machine 
- [ ] Linkfinder 
- [ ] Url with Android application 

### Manual checking - 手动检查 
- [ ] [Shodan](https://www.shodan.io/) 
- [ ] Censys
- [ ] Google dorks 
- [ ] Pastebin 
- [ ] [Github](https://github.com)
- [ ] OSINT 

### <a name="Information">Information Gathering - 信息收集</a>
- [ ] Manually explore the site - 手动浏览站点 
- [ ] Spider/crawl for missed or hidden content - 抓取丢失或隐藏的内容
- [ ] Check for files that expose content, such as robots.txt, sitemap.xml, .DS_Store - 检查暴露内容的文件，例如 robots.txt、sitemap.xml、.DS_Store
- [ ] Check the caches of major search engines for publicly accessible sites - 检查主要搜索引擎的缓存以获取可公开访问的站点
- [ ] Check for differences in content based on User Agent (eg, Mobile sites, access as a Search engine Crawler) - 检查基于用户代理的内容差异（例如，移动站点，作为搜索引擎爬虫访问）
- [ ] Perform Web Application Fingerprinting - 执行 Web 应用程序指纹识别
- [ ] Identify technologies used - 确定所使用的技术
- [ ] Identify user roles - 识别用户角色
- [ ] Identify application entry points - 确定应用程序入口点
- [ ] Identify client-side code - 识别客户端代码
- [ ] Identify multiple versions/channels (e.g. web, mobile web, mobile app, web services) - 识别多个版本/渠道（例如网络、移动网络、移动应用程序、网络服务）
- [ ] Identify co-hosted and related applications - 确定共同托管和相关的应用程序
- [ ] Identify all hostnames and ports - 识别所有主机名和端口
- [ ] Identify third-party hosted content - 识别第三方托管内容
- [ ] Identify Debug parameters - 确定调试参数


### <a name="Configuration">Configuration Management - 配置管理</a>
- [ ] Check for commonly used application and administrative URLs - 检查常用的应用程序和管理 URL
- [ ] Check for old, backup and unreferenced files - 检查旧的、备份的和未引用的文件
- [ ] Check HTTP methods supported and Cross Site Tracing (XST) - 检查支持的 HTTP 方法和跨站点跟踪 (XST)
- [ ] Test file extensions handling - 测试文件扩展名处理
- [ ] Test for security HTTP headers (e.g. CSP, X-Frame-Options, HSTS) - 测试安全 HTTP 标头（例如 CSP、X-Frame-Options、HSTS）
- [ ] Test for policies (e.g. Flash, Silverlight, robots) - 测试策略（例如 Flash、Silverlight、robots）
- [ ] Test for non-production data in live environment, and vice-versa - 在实时环境中测试非生产数据，反之亦然
- [ ] Check for sensitive data in client-side code (e.g. API keys, credentials) - 检查客户端代码中的敏感数据（例如 API 密钥、凭据）


### <a name="Transmission">Secure Transmission - 安全传输</a>
- [ ] Check SSL Version, Algorithms, Key length - 检查 SSL 版本、算法、密钥长度
- [ ] Check for Digital Certificate Validity (Duration, Signature and CN) - 检查数字证书的有效性（持续时间、签名和 CN）
- [ ] Check credentials only delivered over HTTPS - 检查仅通过 HTTPS 传送的凭据
- [ ] Check that the login form is delivered over HTTPS - 检查登录表单是否通过 HTTPS 传送
- [ ] Check session tokens only delivered over HTTPS - 检查仅通过 HTTPS 传递的会话令牌
- [ ] Check if HTTP Strict Transport Security (HSTS) in use - 检查是否正在使用 HTTP 严格传输安全 (HSTS)


### <a name="Authentication">Authentication - 身份认证</a>
- [ ] Test for user enumeration - 测试用户枚举
- [ ] Test for authentication bypass - 测试登陆绕过
- [ ] Test for bruteforce protection - 暴力保护测试
- [ ] Test password quality rules - 测试密码质量规则
- [ ] Test remember me functionality - 测试记住密码
- [ ] Test for autocomplete on password forms/input - 测试密码表单/输入的自动完成
- [ ] Test password reset and/or recovery - 测试密码重置和恢复
- [ ] Test password change process - 测试密码更改过程
- [ ] Test CAPTCHA - 测试验证码
- [ ] Test multi factor authentication - 测试多因素身份验证
- [ ] Test for logout functionality presence - 测试是否存在注销功能
- [ ] Test for cache management on HTTP (eg Pragma, Expires, Max-age) - HTTP 缓存管理测试（例如 Pragma、Expires、Max-age）
- [ ] Test for default logins - 测试默认登录
- [ ] Test for user-accessible authentication history - 测试用户可访问的身份验证历史
- [ ] Test for out-of channel notification of account lockouts and successful password changes - 测试帐户锁定和成功更改密码的频道外通知
- [ ] Test for consistent authentication across applications with shared authentication schema / SSO - 使用共享身份验证架构 / SSO 测试跨应用程序的一致身份验证


### <a name="Session">Session Management - 会话管理</a>
- [ ] Establish how session management is handled in the application (eg, tokens in cookies, token in URL) - 建立应用程序中会话管理的处理方式（例如，cookie 中的令牌、URL 中的令牌）
- [ ] Check session tokens for cookie flags (httpOnly and secure) - 检查会话令牌的 cookie 标志（httpOnly 和安全）
- [ ] Check session cookie scope (path and domain) - 检查会话 cookie 范围（路径和域名）
- [ ] Check session cookie duration (expires and max-age) - 检查会话 cookie 持续时间（过期和最大年龄）
- [ ] Check session termination after a maximum lifetime - 在最长生命周期后检查会话终止
- [ ] Check session termination after relative timeout - 在相对超时后检查会话终止
- [ ] Check session termination after logout - 注销后检查会话终止
- [ ] Test to see if users can have multiple simultaneous sessions - 测试用户是否可以同时进行多个会话
- [ ] Test session cookies for randomness - 测试会话 cookie 的随机性
- [ ] Confirm that new session tokens are issued on login, role change and logout - 确认在登录、角色更改和注销时发出新的会话令牌
- [ ] Test for consistent session management across applications with shared session management - 使用共享会话管理测试跨应用程序的一致会话管理
- [ ] Test for session puzzling - 测试会话困惑
- [ ] Test for CSRF and clickjacking - 测试 CSRF 和点击劫持


### <a name="Authorization">Authorization - 授权</a>
- [ ] Test for path traversal - 测试路径遍历
- [ ] Test for bypassing authorization schema - 测试绕过授权模式
- [ ] Test for vertical Access control problems (a.k.a. Privilege Escalation) - 测试权限提升
- [ ] Test for horizontal Access control problems (between two users at the same privilege level) - 测试横向访问控制问题（在相同权限级别的两个用户之间）
- [ ] Test for missing authorization - 测试缺少授权


### <a name="Validation">Data Validation - 数据验证</a>
- [ ] Test for Reflected Cross Site Scripting - 测试反射跨站脚本（反射型XSS）
- [ ] Test for Stored Cross Site Scripting - 测试存储型跨站脚本（存储型XSS）
- [ ] Test for DOM based Cross Site Scripting - 测试DOM型跨站脚本（DOM型XSS）
- [ ] Test for Cross Site Flashing - 测试跨站闪烁？
- [ ] Test for HTML Injection - HTML 注入测试
- [ ] Test for SQL Injection - SQL 注入测试
- [ ] Test for LDAP Injection -  LDAP 注入测试
- [ ] Test for ORM Injection - ORM 注入测试
- [ ] Test for XML Injection - XML 注入测试
- [ ] Test for XXE Injection - XXE注入测试
- [ ] Test for SSI Injection - SSL注入测试
- [ ] Test for XPath Injection - XPath注入测试
- [ ] Test for XQuery Injection - XQuery注入测试
- [ ] Test for IMAP/SMTP Injection - IMAP/SMTP注入测试
- [ ] Test for Code Injection - 代码注入测试
- [ ] Test for Expression Language Injection - 表达式语言注入测试
- [ ] Test for Command Injection - 命令注入测试
- [ ] Test for Overflow (Stack, Heap and Integer) - 溢出测试（堆栈、堆和整数）
- [ ] Test for Format String - 测试格式化字符串
- [ ] Test for incubated vulnerabilities - 测试孵化漏洞
- [ ] Test for HTTP Splitting/Smuggling - HTTP 拆分/走私测试
- [ ] Test for HTTP Verb Tampering - HTTP 动词篡改测试
- [ ] Test for Open Redirection - 测试开放重定向
- [ ] Test for Local File Inclusion - 测试本地文件包含
- [ ] Test for Remote File Inclusion - 测试远程文件包含
- [ ] Compare client-side and server-side validation rules - 比较客户端和服务器端验证规则
- [ ] Test for NoSQL injection - NoSQL 注入测试
- [ ] Test for HTTP parameter pollution - HTTP 参数污染测试
- [ ] Test for auto-binding - 测试自动绑定
- [ ] Test for Mass Assignment - 批量分配测试
- [ ] Test for NULL/Invalid Session Cookie - 测试 NULL/无效会话 Cookie


### <a name="Denial">Denial of Service - 拒绝服务</a>
- [ ] Test for anti-automation - 反自动化测试
- [ ] Test for account lockout - 测试帐户锁定
- [ ] Test for HTTP protocol DoS - HTTP 协议 DoS 测试
- [ ] Test for SQL wildcard DoS - 测试 SQL 通配符 DoS


### <a name="Business">Business Logic - 业务逻辑</a>
- [ ] Test for feature misuse - 测试功能滥用
- [ ] Test for lack of non-repudiation - 缺乏不可否认性测试
- [ ] Test for trust relationships - 测试信任关系
- [ ] Test for integrity of data - 测试数据的完整性
- [ ] Test segregation of duties - 测试职责分离


### <a name="Cryptography">Cryptography - 密码学</a>
- [ ] Check if data which should be encrypted is not - 检查应该被加密的数据是否未被加密
- [ ] Check for wrong algorithms usage depending on context - 根据上下文检查错误的算法用法
- [ ] Check for weak algorithms usage - 检查弱算法的使用
- [ ] Check for proper use of salting - 检查是否正确加盐
- [ ] Check for randomness functions - 检查随机函数


### <a name="File">File Uploads - 文件上传</a>
- [ ] Test that acceptable file types are whitelisted - 测试可接受的文件类型是否被列入白名单
- [ ] Test that file size limits, upload frequency and total file counts are defined and are enforced - 测试文件大小限制、上传频率和文件总数是否已定义并强制执行
- [ ] Test that file contents match the defined file type - 测试文件内容是否与定义的文件类型匹配
- [ ] Test that all file uploads have Anti-Virus scanning in-place - 测试所有上传的文件都进行了反病毒扫描
- [ ] Test that unsafe filenames are sanitised - 测试不安全的文件名是否被清理
- [ ] Test that uploaded files are not directly accessible within the web root - 测试上传的文件不能在 web 根目录中直接访问
- [ ] Test that uploaded files are not served on the same hostname/port - 测试上传的文件不在相同的主机名/端口上
- [ ] Test that files and other media are integrated with the authentication and authorisation schemas - 测试文件和其他媒体是否与身份验证和授权模式集成


### <a name="Card">Card Payment - 卡支付</a>
- [ ] Test for known vulnerabilities and configuration issues on Web Server and Web Application - 测试 Web 服务器和 Web 应用程序上的已知漏洞和配置问题
- [ ] Test for default or guessable password - 测试默认或可猜测的密码
- [ ] Test for non-production data in live environment, and vice-versa - 在实时环境中测试非生产数据，反之亦然
- [ ] Test for Injection vulnerabilities - 测试注入漏洞
- [ ] Test for Buffer Overflows - 测试缓冲区溢出
- [ ] Test for Insecure Cryptographic Storage - 测试不安全的加密存储
- [ ] Test for Insufficient Transport Layer Protection - 测试传输层保护不足
- [ ] Test for Improper Error Handling - 测试错误处理不当
- [ ] Test for all vulnerabilities with a CVSS v2 score > 4.0 - 测试所有 CVSS v2 分数 > 4.0 的漏洞
- [ ] Test for Authentication and Authorization issues - 测试身份验证和授权问题
- [ ] Test for CSRF - 测试 CSRF


### <a name="HTML">HTML 5</a>
- [ ] Test Web Messaging - 测试网络消息
- [ ] Test for Web Storage SQL injection - 测试 Web Storage SQL 注入
- [ ] Check CORS implementation - 检查 CORS 实现
- [ ] Check Offline Web Application - 检查离线 Web 应用程序

Source: 
[OWASP](https://www.owasp.org/index.php/Web_Application_Security_Testing_Cheat_Sheet) 
[OWASP] https://github.com/OWASP/CheatSheetSeries
[0xpatrick subdomain enumeration workflow](https://0xpatrik.com/subdomain-enumeration-2019/)

Credits:-
- [Sehno](https://github.com/sehno/Bug-bounty)
